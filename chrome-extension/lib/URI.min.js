function URI(b){b||(b="");b=b.match(/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/);this.scheme=b[1]||null;this.authority=b[2]||null;this.path=b[3]||null;this.query=b[4]||null;this.fragment=b[5]||null}URI.prototype.toString=function(){var b="";this.scheme&&(b+=this.scheme+":");this.authority&&(b+="//"+this.authority);this.path&&(b+=this.path);this.query&&(b+="?"+this.query);this.fragment&&(b+="#"+this.fragment);return b};
(function(){function b(a){if(!a)return"";a=a.replace(/\/\.\//g,"/");for(a=a.replace(/\/\.$/,"/");a.match(e);)a=a.replace(e,"/");for(a=a.replace(/\/([^\/]*)\/\.\.$/,"/");a.match(/\/\.\.\//);)a=a.replace(/\/\.\.\//,"/");return a}var e=/\/((?!\.\.\/)[^\/]*)\/\.\.\//;URI.prototype.resolve=function(a){var c=new URI;if(this.scheme)c.scheme=this.scheme,c.authority=this.authority,c.path=b(this.path),c.query=this.query;else{if(this.authority)c.authority=this.authority,c.path=b(this.path),c.query=this.query;
else{if(this.path){if(this.path.charAt(0)==="/")c.path=b(this.path);else{var d;d=this.path;var e=/^(.*)\//;d=a.authority&&!a.path?"/"+d:a.path.match(e)[0]+d;c.path=d;c.path=b(c.path)}c.query=this.query}else c.path=a.path,c.query=this.query?this.query:a.query;c.authority=a.authority}c.scheme=a.scheme}c.fragment=this.fragment;return c}})();
